function Command(t){var i=!1;return void 0!==t&&t&&"object"==typeof t&&1===t.nodeType?(this.container=t,this.ui=null,this.value="",this.disabled=!1,this.history=[],this.historyCount=null,this.currentString="",this.width="100%",this.height="300px",this.backgroundColor="#222",this.commands={},this.setup=function(){this.ui=document.createElement("textarea"),this.ui.className="command-interface",this.container.style.width=this.width,this.container.style.height=this.height,this.container.style.position="relative",this.ui.style.backgroundColor=this.backgroundColor,this.ui.style.position="absolute",this.ui.style.left="0px",this.ui.style.top="0px",this.ui.style.bottom="0px",this.ui.style.width=this.width,this.ui.style.overflow="hidden",this.ui.setAttribute("type","hidden"),this.ui.readOnly=!0,this.container.appendChild(this.ui),this.value="",this.ui.value=this.value+"> "+this.currentString+"\n\n\n\n",_this=this,setInterval(function(){_this.ui.value===_this.value+"> "+_this.currentString+"\n\n\n\n"&&document.activeElement===_this.ui?_this.ui.value=_this.value+(_this.disabled?"":"> "+_this.currentString+"_")+"\n\n\n\n":_this.ui.value=_this.value+(_this.disabled?"":"> "+_this.currentString)+"\n\n\n\n",_this.ui.scrollTop=1e6},500),document.addEventListener("keydown",function(t){return _this.disabled?!1:void(document.activeElement===_this.ui&&(8===t.which?(t.preventDefault(),_this.currentString=_this.currentString.substring(0,_this.currentString.length-1),_this.ui.value=_this.value+"> "+_this.currentString+"\n\n\n\n"):38===t.which?_this.backHistory():40===t.which&&_this.forwardHistory()))},!1),this.ui.addEventListener("keypress",function(t){if(_this.disabled)return!1;if(8===t.which&&t.preventDefault(),(t.which>47&&t.which<58||t.which>64&&t.which<91||32===t.which||t.which>96&&t.which<123||230===t.which||248===t.which||229===t.which||198===t.which||216===t.which||197===t.which)&&(_this.currentString+=t.key,_this.ui.value=_this.value+"> "+_this.currentString+"\n\n\n\n"),13===t.which){_this.history.unshift(_this.currentString);var i=_this.value+"> "+_this.currentString+"\n";_this.value=i,_this.ui.value=_this.value+"\n\n\n\n",_this.run(_this.currentString)}},!0)},void this.setup()):(i&&console.log("Missing container"),!1)}Command.prototype.disable=function(){this.disabled=!0},Command.prototype.enable=function(){this.disabled=!1},Command.prototype["import"]=function(t){return void 0===t||"object"!=typeof t?(debug&&console.log("missing or invalid object"),!1):(this.commands=t,!0)},Command.prototype.add=function(t,i){if(void 0===t||void 0===i||"string"!=typeof t||"string"!=typeof i&&"function"!=typeof i)return debug&&console.log("missing or invalid parameters"),!1;for(var n=t.split("."),h=this.commands,s=0;s<n.length;s++){var e=n[s].toLowerCase();void 0===h[e]&&(h[e]=s<n.length-1?{}:i),h=h[e]}return!0},Command.prototype.backHistory=function(){return this.history.length<1?!1:(null===this.historyCount&&(this.historyCount=this.history.length-1),this.historyCount=this.historyCount<this.history.length-1?this.historyCount+1:0,this.currentString=this.history[this.historyCount],!0)},Command.prototype.forwardHistory=function(){return this.history.length<1?!1:(null===this.historyCount&&(this.historyCount=0),this.historyCount=this.historyCount<=0?this.history.length-1:this.historyCount-1,this.currentString=this.history[this.historyCount],!0)},Command.prototype.setSize=function(t,i){void 0!==t&&("number"==typeof t?this.width=t+"px":"string"==typeof t&&(this.width=t)),void 0!==i&&("number"==typeof i?this.height=i+"px":"string"==typeof i&&(this.width=i)),this.container.style.width=this.width,this.container.style.height=this.height,this.ui.style.width=this.width},Command.prototype.run=function(t){if(_this.currentString="",(void 0===t||"string"!=typeof t)&&this.print("[error] command not found"),""!==t){for(var i=t.split(" "),n=this.commands,h=0;h<i.length&&void 0!==n[i[h].toLowerCase()];h++)n=n[i[h].toLowerCase()];"string"==typeof n?this.print(n):"function"==typeof n?n():"object"==typeof n&&void 0!==n["default"]?this.print(n["default"]):this.print("[error] command not found")}this.historyCount=null,this.ui.scrollTop=1e6},Command.prototype.print=function(t){return void 0===t||"string"!=typeof t?!1:(this.historyCount=null,this.value=this.value+"> "+t+"\n",void(this.ui.value=this.value+(this.disabled?"":"> "+this.currentString)+"\n\n\n\n"))};